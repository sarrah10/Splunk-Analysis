# Analyzing VPN Log Files Using Splunk SIEM

## Overview
This lab focuses on ingesting VPN log data into Splunk SIEM and performing structured analysis using Search Processing Language (SPL). The objective is to practice log ingestion, filtering, correlation, and event counting—core skills required for a SOC Analyst.

## Project Overview
In this project, we will upload sample VPN log files to Splunk SIEM and perform various analyses.

## Steps to Upload Sample VPN Log Files to Splunk SIEM

Log Source: [vpn_logs](https://drive.google.com/file/d/16w5M3Qxh5kMK6gbS7I-4FIvdF5fE6mvE/view?usp=sharing)

The VPN log file was uploaded into Splunk using the Add Data → Upload method.

### Steps Followed

- Select Source: Selected the VPN log file and confirmed the data source.
- Select Source Type: Chose the appropriate log format (e.g., JSON, syslog) to ensure correct field extraction.
- Input Settings: Selected the destination index for log storage and Assigned a hostname to associate with the events.
- Review: Reviewed all configurations before ingestion.
- Done: Completed the upload. The data was successfully indexed and ready for analysis.

## SPL Queries and Analysis

### 1. Filtering Events by Country (Excluding France)

SPL Query
```
index=<your_vpn_index> sourcetype=<your_vpn_sourcetype>
Source_Country!="France"
```
Why this was used
- This query filters out all VPN events originating from France and displays logs from all other countries. It helps narrow down the investigation scope by excluding known or trusted geographic locations.

### 2. Counting Events Excluding France

SPL Query
```
index=<your_vpn_index> sourcetype=<your_vpn_sourcetype>
Source_Country!="" Source_Country!="France"
| stats count
```
Why this was used
- This command counts the total number of VPN events originating from countries other than France while excluding empty or null country values, ensuring accurate event statistics.

### 3. Identifying Username Associated with a Specific IP

SPL Query
```
index=<your_vpn_index> sourcetype=<your_vpn_sourcetype>
Source_ip="107.14.182.38"
| stats values(UserName)
```

Why this was used
- This query identifies the username(s) associated with a specific source IP address. It is useful for correlating suspicious IP activity with user accounts during incident investigation.

### 4. Counting VPN Events from a Specific IP Address

SPL Query
```
index=<your_vpn_index> sourcetype=<your_vpn_sourcetype>
Source_ip="107.3.206.58"
| stats count
```

Why this was used
- This command counts the number of VPN events generated by a specific IP address, helping determine activity volume and detect potential misuse or anomalous behavior.

### 5. Verifying Log Ingestion and Total Event Count

SPL Query
```
index=<your_vpn_index> sourcetype=<your_vpn_sourcetype>
| stats count
```

Why this was used
- This query confirms that the VPN logs were successfully ingested into Splunk and provides the total number of events present in the index.

### 6. Counting Events Generated by a Specific User

SPL Query
```
index=<your_vpn_index> sourcetype=<your_vpn_sourcetype>
UserName="Maleena"
| stats count
```

Why this was used
- This query counts all VPN log events associated with the user Maleena, allowing analysts to assess user activity levels and identify unusual or excessive behavior.

## Key Learnings

- Hands-on experience with Splunk data ingestion
- Filtering and counting events using SPL
- Correlating IP addresses with usernames
- Analyzing VPN activity for SOC investigations

This lab demonstrates foundational SOC L1 / SIEM analysis skills essential for real-world security monitoring and incident response.
